<!DOCTYPE html>
<html lang="en" dir="ltr" class="dark-mode">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Luma</title>

    <!-- Prevent the demo from appearing in search engines -->
    <meta name="robots" content="noindex">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CRoboto:400,500%7CExo+2:600&display=swap"
        rel="stylesheet">

    <!-- Preloader -->
    <link type="text/css" href="public/vendor/spinkit.css" rel="stylesheet">

    <!-- Perfect Scrollbar -->
    <link type="text/css" href="public/vendor/perfect-scrollbar.css" rel="stylesheet">

    <!-- Material Design Icons -->
    <link type="text/css" href="public/css/material-icons.css" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link type="text/css" href="public/css/fontawesome.css" rel="stylesheet">

    <!-- Preloader -->
    <link type="text/css" href="public/css/preloader.css" rel="stylesheet">

    <!-- App CSS -->
    <link type="text/css" href="public/css/app.css" rel="stylesheet">

    <!-- Dark Mode CSS -->
    <link type="text/css" href="public/css/dark.css" rel="stylesheet">

    <!-- my css styles -->
    <link rel="stylesheet" href="myCss/mine.css">

    <!-- my added bootstrap.css -->
    <!-- <link rel="stylesheet" type="text/css" href="myCss/bootstrap.css"> -->
    
</head>

<body class="layout-app ">

   

    <div class="preloader">
        <div class="sk-chase">
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
        </div>


    </div>

    <!-- Drawer Layout -->


    
    <div class="mdk-drawer-layout js-mdk-drawer-layout" data-push data-responsive-width="992px">
        <div class="mdk-drawer-layout__content page-content">

            <!-- Header -->

            <div id="myHeader"></div>

            <!-- // END Header -->

            <!-- BEFORE Page Content -->

            <!-- // END BEFORE Page Content -->

            <!-- Page Content -->
            <div class="page-section border-bottom-2">
                <div class="container page__container">

                    <div class="row">
                        <div class="col-md-8">

                            <div class="page-separator">
                                <div class="page-separator__text">Basic information</div>
                            </div>

                            <label class="form-label">Course title</label>
                            <div class="form-group mb-24pt">
                                <input type="text"
                                       class="form-control form-control-lg"
                                       id="courseName"
                                       name="courseName"
                                       placeholder="Course title"
                                       value="">
                                <small class="form-text text-muted">Please see our <a href="">course title guideline</a></small>
                            </div>

                            <div class="form-group mb-32pt">
                                <label class="form-label">Description</label>
                                <!-- <textarea class="form-control" rows="3" placeholder="Course description"></textarea> -->
                                <div style="height: 150px;"
                                     class="mb-0"
                                     data-toggle="quill"
                                     data-quill-placeholder="Course description">
                                   
                                     <input type="text"
                                       class="form-control form-control-lg"
                                       id="description"
                                       name="description"
                                       placeholder="provide a description for the course"
                                       value="">
                                    <p><br></p>
                                </div>
                                <small class="form-text text-muted">Shortly describe this course.</small>
                            </div>

                            <div class="page-separator">
                                <div class="page-separator__text">Sections</div>
                            </div>

                            <div class="accordion js-accordion accordion--boxed mb-24pt"
                                 id="parent">
                                <div class="accordion__item">
                                    <a href="#"
                                       class="accordion__toggle collapsed"
                                       data-toggle="collapse"
                                       data-target="#course-toc-1"
                                       data-parent="#parent">
                                        <span class="flex">Course Overview</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse"
                                         id="course-toc-1">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Watch Trailer</a>
                                            <span class="text-muted">1m 10s</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion__item open">
                                    <a href="#"
                                       class="accordion__toggle"
                                       data-toggle="collapse"
                                       data-target="#course-toc-2"
                                       data-parent="#parent">
                                        <span class="flex">Getting Started with Angular</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse show"
                                         id="course-toc-2">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Introduction</a>
                                            <span class="text-muted">8m 42s</span>
                                        </div>
                                        <div class="accordion__menu-link active">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Introduction to TypeScript</a>
                                            <span class="text-muted">50m 13s</span>
                                        </div>
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Comparing Angular to AngularJS</a>
                                            <span class="text-muted">12m 10s</span>
                                        </div>
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-take-quiz.html">Quiz: Getting Started With Angular</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion__item">
                                    <a href="#"
                                       class="accordion__toggle collapsed"
                                       data-toggle="collapse"
                                       data-target="#course-toc-3"
                                       data-parent="#parent">
                                        <span class="flex">Creating and Communicating Between Angular Components</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse"
                                         id="course-toc-3">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Angular Components</a>
                                            <span class="text-muted">04:23</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion__item">
                                    <a href="#"
                                       class="accordion__toggle collapsed"
                                       data-toggle="collapse"
                                       data-target="#course-toc-4"
                                       data-parent="#parent">
                                        <span class="flex">Exploring the Angular Template Syntax</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse"
                                         id="course-toc-4">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Template Syntax</a>
                                            <span class="text-muted">04:23</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <a href="#"
                               class="btn btn-outline-secondary mb-24pt mb-sm-0">Add Section</a>

                        </div>
                        <div class="col-md-4">

                            <div class="card">
                                <div class="card-header text-center">
                                    <button type="submit" class="btn btn-primary" id="saveChangesBtn">Save</button>
                                </div>
                                <div class="list-group list-group-flush">
                                    <div class="list-group-item d-flex">
                                        <a class="flex"
                                           href="#"><strong>Save Draft</strong></a>
                                        <i class="material-icons text-muted">check</i>
                                    </div>
                                    <div class="list-group-item">
                                        <a href="#"
                                           class="text-danger"><strong>Delete Course</strong></a>
                                    </div>
                                </div>
                            </div>

                            <div class="page-separator">
                                <div class="page-separator__text">Video</div>
                            </div>

                            <div class="card">
                                <div class="embed-responsive embed-responsive-16by9">
                                    <iframe class="embed-responsive-item"
                                            src="https://player.vimeo.com/video/97243285?title=0&amp;byline=0&amp;portrait=0"
                                            allowfullscreen=""></iframe>
                                </div>
                                <div class="card-body">
                                    <label class="form-label">URL</label>
                                    <input type="text"
                                           class="form-control"
                                           value="https://player.vimeo.com/video/97243285?title=0&amp;byline=0&amp;portrait=0"
                                           placeholder="Enter Video URL">
                                    <small class="form-text text-muted">Enter a valid video URL.</small>
                                </div>
                            </div>

                            <div class="page-separator">
                                <div class="page-separator__text">Options</div>
                            </div>

                            <div class="card">
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Category</label>
                                        <select name="portalName" id="portalName"

                                                class="form-control custom-select">
                                            <option value="vuejs">VueJs</option>
                                            <option value="vuejs">Angular</option>
                                            <option value="vuejs">React</option>
                                        </select>
                                        <small class="form-text text-muted">Select a category.</small>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Price</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="input-group form-inline">
                                                    <span class="input-group-prepend"><span class="input-group-text">$</span></span>
                                                    <input type="text"
                                                           class="form-control"
                                                           name="price"
                                                           id="price"
                                                           value="">
                                                </div>
                                            </div>
                                        </div>
                                        <small class="form-text text-muted">The recommended price is between &dollar;17 and &dollar;24</small>
                                    </div>
                                    <div class="form-group mb-0">
                                        <label class="form-label"
                                               for="select03">Tags</label>
                                        <select id="select03"
                                                data-toggle="select"
                                                multiple
                                                class="form-control">
                                            <option selected="">JavaScript</option>
                                            <option selected="">Angular</option>
                                            <option>Bootstrap</option>
                                            <option>CSS</option>
                                            <option>HTML</option>
                                        </select>
                                        <small class="form-text text-muted">Select one or more tags.</small>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>
            </div>

           

            <div id="myFooter"></div>
        </div>

        <!-- // END drawer-layout__content -->

        <!-- Drawer -->

        <div class="mdk-drawer js-mdk-drawer" id="default-drawer">
            <div class="mdk-drawer__content">
                <div class="sidebar sidebar-black-dodger-blue sidebar-left" data-perfect-scrollbar>
                    <div id="mySidebar"></div>
                    <!-- Sidebar Content -->
                </div>
            </div>

            <!-- // END Drawer -->

        </div>
    </div>


    <!-- // END Drawer Layout -->

    <!-- Header -->
    <script src="components/header.js"></script>

    <!-- Footer -->
    <script src="components/footer.js"></script>

    <!-- sidebar -->
    <script src="components/sidebar.js"></script>
    <!-- jQuery -->
    <script src="public/vendor/jquery.min.js"></script>

    <!-- Bootstrap -->
    <script src="myJS/bootstrap.bundle.min.js"></script>
    <script src="public/vendor/popper.min.js"></script>
    <script src="public/vendor/bootstrap.min.js"></script>

    <!-- Perfect Scrollbar -->
    <script src="public/vendor/perfect-scrollbar.min.js"></script>

    <!-- DOM Factory -->
    <script src="public/vendor/dom-factory.js"></script>

    <!-- MDK -->
    <script src="public/vendor/material-design-kit.js"></script>

    <!-- App JS -->
    <script src="public/js/app.js"></script>

    <!-- Preloader -->
    <script src="public/js/preloader.js"></script>


    <!-- added scripts not included in template -->
    <!-- Datatable js-->
    <script src="myJS/datatables/jquery.dataTables.min.js"></script>
    <script src="myJS/datatables/custom-basic.js"></script>
    <script src="myJS/QueryStringDivider.js"></script>

    <script>
        
    

        const urlParams = new URLSearchParams(window.location.search);
    
        // Get the value of the 'trainerId' parameter
        const trainerId = urlParams. get('trainerId');
    
        // Get the value of the 'courseId' parameter
        const courseId = urlParams.get('courseId');
        function saveChanges(){
                var courseName = $('#courseName').val();
                var description = $('#description').val();
                var price = $('#price').val();
                var portalId = $('#portalName').val();
                const data = { courseId:courseId,
                courseName:courseName,
                description:description,
                price:price,
                 portalId: portalId
        } 
        const data1={
            courseName:courseName,
                description:description,
                price:price,
                 portalId: portalId,
                 trainerId:trainerId
        }
        console.log(data1);

        if(courseId){
    $.ajax({
        url: 'api/vwCourses.php?status=update', // Server-side script to fetch portal names
        method: 'POST',
        data: data,
        // required parameters
        success: function(response) {
            // Parse the JSON response
            console.log("successful"+response);
           
            } ,
        
        error: function(xhr) {
            console.error(xhr.responseText);
          
            // Handle error gracefully
            $('#portalName').append('<option value="">Error fetching portals</option>');
        }
    });
        }
        else{
            $.ajax({
        url: 'api/vwCourses.php?status=new', // Server-side script to fetch portal names
        method: 'POST',
        data: data1,
        // required parameters
        success: function(response) {
            // Parse the JSON response
            console.log("successful new"+response);
           
            } ,
        
        error: function(xhr) {
            console.error(xhr.responseText);
          
            // Handle error gracefully
          
        }
    });
        }




        }
        function populatePortalName() {
    $.ajax({
        url: 'api/webCoursePortal.php', // Server-side script to fetch portal names
        method: 'GET',
        data: { status: 'select' }, // Optionally, pass any required parameters
        success: function(response) {
            // Parse the JSON response
            
            var data = JSON.parse(response);

            // Clear existing options in the category dropdown
            $('#portalName').empty();

            // Check if data is not empty and has portal names
            if (data.length > 0) {
                // Iterate through the portal names and populate the dropdown
                data.forEach(function(item) {
                    $('#portalName').append(`<option value="${item.portalId}">${item.portalName}</option>`);
                   
                });
            } else {
                // Handle empty or missing portal names
                $('#portalName').append('<option value="">No portals found</option>');
            }
        },
        error: function(xhr) {
            console.error(xhr.responseText);
          
            // Handle error gracefully
            $('#portalName').append('<option value="">Error fetching portals</option>');
        }
    });
}

// Call the function to populate portal names




        function populateCourseName() {
            // Check if courseId is not null
          
                $.ajax({
                    url: 'api/vwCourses.php', // Server-side script to fetch course name
                    method: 'GET',
                    data: { status:'one',
                        courseId: courseId }, // Send course ID to the server
                    success: function(response) {
                        // Parse the JSON response
                    //    console.log(response);
                        var data = JSON.parse(response);

// Check if data is not empty and has courseName
var x=data[0].portalId;
if (data.length > 0) {
   
    $.ajax({
      url: 'api/webCoursePortal.php?status=one',
      data:{portalId: data[0].portalId},
     
      method: 'GET',
      success: function(portalResponse) {
        var portalData = JSON.parse(portalResponse);
        if (portalData.length > 0) {
          // Set the selected option in the dropdown
          $('#portalName option[value="' + portalData[0].portalId + '"]').prop('selected', true);
        } else {
          console.warn("Couldn't find portal details for course");
        }
      },
      error: function(xhr) {
        console.error(xhr.responseText);
      }
    });
    
    $('#courseName').val(data[0].courseName);
    
    // Set description if available
    if (data[0].description !== undefined && data[0].description !== null) {
        $('#description').val(data[0].description);
    }

    // Set price if available
    if (data[0].price !== undefined) {
        $('#price').val(data[0].price);
    }
   
} else {
    // Handle empty or missing courseName
    $('#courseName').val('Error: Course data not found');
}


                    },
                    error: function(xhr) {
                        console.error(xhr.responseText);
                        // Handle error gracefully
                        $('#courseName').val('Error: Unable to fetch course name');
                    }
                });
           
        }


        $(document).ready(function() {
            populatePortalName();
            if(courseId){
            populateCourseName();
           }
          
            $('#saveChangesBtn').click(function() {
            saveChanges();
            window.location.href='courses.html?trainerId='+trainerId;
    });

        });
       
    </script>
    
    


</body>

</html>